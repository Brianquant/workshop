<!doctype html>
<html lang="de">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>MeetUp â€“ Community Events</title>
  <meta name="description" content="Free community events in your city. RSVP in under a minute." />
  <link rel="stylesheet" href="style.css">
</head>
<body>
  <header>
    <div class="brand">MEETUP Â· COMMUNITY</div>
    <div class="hero">
      <h1>Easy-going events ğŸ’¬ğŸ¸ â€“ claim a free spot</h1>
      <p>Pick an event, drop your <strong>first name</strong>, <strong>email</strong> and a few quick details so we can match Erasmus students, locals and internationals for the best vibes.</p>
      <div class="controls">
        <input id="q" class="search" placeholder="Search: cocktails, networking, runningâ€¦" />
        <button class="btn" id="reset">Reset</button>
      </div>
    </div>
  </header>

  <section class="notice">
    <p>Quick heads-up: we only light up an event when enough people confirmed â€“ that keeps things cozy and no one ends up sipping solo. Drop your name, reserve a spot and weâ€™ll email you the final date + details once the crew is ready. âœ‰ï¸âœ¨</p>
  </section>

  <main class="grid" id="grid"></main>

  <dialog id="signup">
    <div class="modal-head">
      <strong>Anmeldung</strong>
      <button class="x" aria-label="Close" onclick="closeModal()">Ã—</button>
    </div>
    <form id="form" name="event-signup" class="modal-body" method="POST" data-netlify="true" netlify-honeypot="company" action="/">
      <!-- Netlify Forms: "event-signup" wird automatisch erfasst. -->
      <input type="hidden" name="event_title" id="event_title" />
      <div class="row">
        <div class="field">
          <label for="first_name">First name *</label>
          <input required id="first_name" name="first_name" type="text" placeholder="e.g. Lea" />
        </div>
        <div class="field">
          <label for="email">Email *</label>
          <input required id="email" name="email" type="email" placeholder="you@uni.de" />
        </div>
      </div>
      <div class="row">
        <div class="field">
          <label for="uni">University *</label>
          <input required id="uni" name="university" type="text" placeholder="e.g. WWU MÃ¼nster" />
        </div>
      </div>
      <div class="field">
        <label for="community_profile">Which option describes you best? *</label>
        <select required id="community_profile" name="community_profile">
          <option value="">Chooseâ€¦</option>
          <option value="erasmus">Erasmus / exchange student</option>
          <option value="local">Local student</option>
          <option value="new">New in town, want to meet people</option>
          <option value="working">Working here, want to meet people</option>
          <option value="other">Other</option>
        </select>
      </div>
      <div class="field">
        <label for="languages">Which languages do you speak well enough for conversations? *</label>
        <textarea required id="languages" name="languages_conversations" rows="2" placeholder="German, English, Frenchâ€¦"></textarea>
      </div>
      <div class="field">
        <label for="preferred_language">Which language feels best for events? *</label>
        <textarea required id="preferred_language" name="preferred_event_language" rows="2" placeholder="e.g. English for workshops, German for chill evenings"></textarea>
      </div>
      <div class="field">
        <label for="date_choice">Which date works for you? *</label>
        <select required id="date_choice" name="preferred_date">
          <option value="">Pick a dateâ€¦</option>
          <option value="fri-05">Friday, 05.12. (evening)</option>
          <option value="sat-06">Saturday, 06.12. (evening)</option>
          <option value="fri-12">Friday, 12.12. (evening)</option>
          <option value="sat-13">Saturday, 13.12. (evening)</option>
          <option value="flex">I canâ€™t make these but Iâ€™m still interested</option>
        </select>
      </div>
      <div class="field">
        <label for="culture_wishlist">Any events from your culture (or others) youâ€™d love to see here?</label>
        <textarea id="culture_wishlist" name="culture_wishlist" rows="4" placeholder="Dance nights (Salsa, Line Danceâ€¦), community cooking, games, music or film nights"></textarea>
        <small>Tell us everything â€“ weâ€™re using your ideas to bring more culture & exchange to the city. ğŸŒ</small>
      </div>
      <!-- Spam-Honeypot (Netlify) -->
      <input type="hidden" name="form-name" value="event-signup" />
      <input type="text" name="company" style="display:none" tabindex="-1" autocomplete="off" />
      <p class="help">By sending the form you agree that we may use your data to organize these community events. Itâ€™s always free.</p>
      <div class="msg" id="msg"></div>
      <div class="modal-foot">
        <button type="button" class="btn" onclick="closeModal()">Cancel</button>
        <button type="submit" class="btn primary">Sign up for free</button>
      </div>
    </form>
  </dialog>

  <footer>
    Â© <span id="year"></span> MeetUp Â· <a href="#" id="impressum">Impressum</a> Â· <a href="#" id="privacy">Privacy</a>
  </footer>

  <script>
    const EVENTS = [
      { id: 'tiki-101', title: 'Tiki Cocktail Network Night', date: '2025-12-05', time: '19:00', city: 'MÃ¼nster', tags: ['Indoor', 'Networking'], spots: 8 },
      { id: 'glw-201', title: 'Frosty GlÃ¼hwein Night am Aasee', date: '2025-12-06', time: '18:00', city: 'MÃ¼nster', tags: ['Outdoor', 'Social'], spots: 20 }
    ];

    const grid = document.getElementById('grid');
    const q = document.getElementById('q');

    function fmtDate(iso) {
      const d = new Date(iso + 'T00:00:00');
      return d.toLocaleDateString('en-GB', { weekday: 'short', day: '2-digit', month: 'short' });
    }

    function render(list) {
      grid.innerHTML = list.map(e => `
        <article class="card" data-id="${e.id}">
          <div class="meta">
            <span class="pill">${fmtDate(e.date)} Â· ${e.time}</span>
            <span class="pill">${e.city}</span>
            <span class="pill">${e.spots} spots</span>
          </div>
          <h3>${e.title}</h3>
          <div class="meta">${e.tags.map(t => `<span class="pill">#${t}</span>`).join('')}</div>
          <div class="cta-row">
            <button class="btn primary" onclick="openModal('${e.title.replace(/'/g, "&#39;")}')">Sign up</button>
            <button class="btn ghost" onclick="share('${e.title.replace(/'/g, "&#39;")}')">Share</button>
          </div>
        </article>
      `).join('');
    }

    function filter() {
      const term = q.value.trim().toLowerCase();
      if (!term) return render(EVENTS);
      const list = EVENTS.filter(e =>
        e.title.toLowerCase().includes(term) ||
        e.city.toLowerCase().includes(term) ||
        e.tags.join(' ').toLowerCase().includes(term)
      );
      render(list);
    }

    document.getElementById('reset').addEventListener('click', () => { q.value = ''; render(EVENTS); });
    q.addEventListener('input', filter);

    const dlg = document.getElementById('signup');
    function openModal(title) {
      document.getElementById('event_title').value = title;
      document.getElementById('msg').className = 'msg';
      document.getElementById('msg').textContent = '';
      dlg.showModal();
    }
    function closeModal() {
      dlg.close();
    }
    window.closeModal = closeModal; window.openModal = openModal;

    async function handleSubmit(e) {
      e.preventDefault();
      const msg = document.getElementById('msg');

      const form = e.target;
      if (!form.reportValidity()) return;
      const data = new FormData(form);
      if (!data.has('form-name') && form.name) data.append('form-name', form.name);
      const body = new URLSearchParams();
      data.forEach((value, key) => body.append(key, value));

      try {
        const res = await fetch(form.action, {
          method: 'POST',
          headers: { 'Content-Type': 'application/x-www-form-urlencoded' },
          body: body.toString()
        });
        if (res.ok) {
          form.reset();
          msg.innerHTML = 'Thanks! Your free registration is in.';
          msg.className = 'msg ok';
        } else {
          msg.textContent = 'Whoops â€“ something went wrong. Please try again later.';
          msg.className = 'msg err';
        }
      } catch (err) {
        msg.textContent = 'Offline? Please check your internet connection.';
        msg.className = 'msg err';
      }
    }
    document.getElementById('form').addEventListener('submit', handleSubmit);

    function share(title) {
      const text = `Join me at "${title}" â€“ free RSVP!`;
      const url = location.href;
      if (navigator.share) navigator.share({ title: document.title, text, url });
      else navigator.clipboard.writeText(url).then(() => alert('Link kopiert!'));
    }
    window.share = share;

    render(EVENTS);
    document.getElementById('year').textContent = new Date().getFullYear();
  </script>
</body>
</html>
